var Fe=Object.defineProperty;var ze=(e,t,n)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var O=(e,t,n)=>ze(e,typeof t!="symbol"?t+"":t,n);import{s as Ge,r as Je,m as Be}from"./q-CibyKIXD.js";import{getNotFound as Ke}from"./@qwik-city-not-found-paths.js";import{isStaticPath as ae}from"./@qwik-city-static-paths.js";import{createReadStream as Xe}from"node:fs";import{join as $,basename as Ye,extname as Ee}from"node:path";import{fileURLToPath as Ve}from"node:url";import{Http2ServerRequest as Ze}from"node:http2";import{TextEncoderStream as qe,TextDecoderStream as et,WritableStream as tt,ReadableStream as nt}from"node:stream/web";import{fetch as rt,Headers as at,Request as it,Response as st,FormData as ot}from"undici";import ct from"crypto";import{v as lt,_ as ft,a as ut,c as dt,i as ht,b as V,d as P,R as mt,Q as pt}from"./q-C3U4F8Wg.js";import gt from"./@qwik-city-plan.js";import Ae from"express";import yt from"compression";function B(e,t){let n="Server Error";return t!=null&&(typeof t.message=="string"?n=t.message:n=String(t)),"<html>"+wt(e,n)+"</html>"}function wt(e,t){typeof e!="number"&&(e=500),typeof t=="string"?t=St(t):t="";const n=typeof t=="string"?"600px":"300px",r=e>=500?xt:Rt;return`
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${t}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${r}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${n}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${r}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${r}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${t}</span></p></body>
`}var bt=/[&<>]/g,St=e=>e.replace(bt,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),Rt="#006ce9",xt="#713fc2",Tt={lax:"Lax",Lax:"Lax",None:"None",none:"None",strict:"Strict",Strict:"Strict"},vt={seconds:1,minutes:1*60,hours:1*60*60,days:1*60*60*24,weeks:1*60*60*24*7},ie=(e,t,n)=>{const r=[`${e}=${t}`];typeof n.domain=="string"&&r.push(`Domain=${n.domain}`),typeof n.maxAge=="number"?r.push(`Max-Age=${n.maxAge}`):Array.isArray(n.maxAge)?r.push(`Max-Age=${n.maxAge[0]*vt[n.maxAge[1]]}`):typeof n.expires=="number"||typeof n.expires=="string"?r.push(`Expires=${n.expires}`):n.expires instanceof Date&&r.push(`Expires=${n.expires.toUTCString()}`),n.httpOnly&&r.push("HttpOnly"),typeof n.path=="string"&&r.push(`Path=${n.path}`);const s=_t(n.sameSite);return s&&r.push(`SameSite=${s}`),n.secure&&r.push("Secure"),r.join("; ")};function se(e){try{return decodeURIComponent(e)}catch{return e}}var At=e=>{const t={};if(typeof e=="string"&&e!==""){const n=e.split(";");for(const r of n){const s=r.indexOf("=");s!==-1&&(t[se(r.slice(0,s).trim())]=se(r.slice(s+1).trim()))}}return t};function _t(e){if(e===!0)return"Strict";if(e===!1)return"None";if(e)return Tt[e]}var C=Symbol("request-cookies"),W=Symbol("response-cookies"),v=Symbol("live-cookies"),xe,Te,ve,Ct=(ve=C,Te=W,xe=v,class{constructor(e){O(this,ve);O(this,Te,{});O(this,xe,{});O(this,"appendCounter",0);this[C]=At(e),this[v]={...this[C]}}get(e,t=!0){const n=this[t?v:C][e];return n?{value:n,json(){return JSON.parse(n)},number(){return Number(n)}}:null}getAll(e=!0){return Object.keys(this[e?v:C]).reduce((t,n)=>(t[n]=this.get(n),t),{})}has(e,t=!0){return!!this[t?v:C][e]}set(e,t,n={}){this[v][e]=typeof t=="string"?t:JSON.stringify(t);const r=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[W][e]=ie(e,r,n)}append(e,t,n={}){this[v][e]=typeof t=="string"?t:JSON.stringify(t);const r=typeof t=="string"?t:encodeURIComponent(JSON.stringify(t));this[W][++this.appendCounter]=ie(e,r,n)}delete(e,t){this.set(e,"deleted",{...t,maxAge:0}),this[v][e]=null}headers(){return Object.values(this[W])}}),N=class extends Error{constructor(e,t){super(typeof t=="string"?t:void 0),this.status=e,this.data=t}},j=class{},q=class extends j{},_e=class extends j{constructor(e){super(),this.pathname=e}},oe=new WeakMap,ce="qaction",kt="qfunc",le="qdata";function Ot(e,t){const n=de(e),r=fe(e),s=de(t),a=fe(t);return Ce(e,n,r,t,s,a)}function Ce(e,t,n,r,s,a){if(r.startsWith("/build/"))return null;let o=null;for(;t<n;){const i=e.charCodeAt(t++),c=r.charCodeAt(s++);if(i===91){const l=ke(e,t),f=t+(l?3:0),d=K(e,f,n,93),u=e.substring(f,d),m=K(e,d+1,n,47),g=e.substring(d+1,m);t=d+1;const w=s-1;if(l){const A=Dt(u,g,r,w,a,e,t+g.length+1,n);if(A)return Object.assign(o||(o={}),A)}const y=K(r,w,a,47,g);if(y==-1)return null;const S=r.substring(w,y);if(!l&&!g&&!S)return null;s=y,(o||(o={}))[u]=decodeURIComponent(S)}else if(i!==c&&!(isNaN(c)&&Pt(e,t)))return null}return ue(e,t)&&ue(r,s)?o||{}:null}function Pt(e,t){return e.charCodeAt(t)===91&&ke(e,t+1)}function fe(e){const t=e.length;return t>1&&e.charCodeAt(t-1)===47?t-1:t}function ue(e,t){const n=e.length;return t>=n||t==n-1&&e.charCodeAt(t)===47}function de(e){return e.charCodeAt(0)===47?1:0}function ke(e,t){return e.charCodeAt(t)===46&&e.charCodeAt(t+1)===46&&e.charCodeAt(t+2)===46}function K(e,t,n,r,s=""){for(;t<n&&e.charCodeAt(t)!==r;)t++;const a=s.length;for(let o=0;o<a;o++)if(e.charCodeAt(t-a+o)!==s.charCodeAt(o))return-1;return t-a}function Dt(e,t,n,r,s,a,o,i){n.charCodeAt(r)===47&&r++;let c=s;const l=t+"/";for(;c>=r;){const f=Ce(a,o,i,n,c,s);if(f){let u=n.substring(r,Math.min(c,s));return u.endsWith(l)&&(u=u.substring(0,u.length-l.length)),f[e]=decodeURIComponent(u),f}const d=Mt(n,r,l,c,r-1)+l.length;if(c===d)break;c=d}return null}function Mt(e,t,n,r,s){let a=e.lastIndexOf(n,r);return a==r-n.length&&(a=e.lastIndexOf(n,r-n.length-1)),a>t?a:s}var Ht=async(e,t,n,r,s)=>{if(!Array.isArray(e))return null;for(const a of e){const o=a[0],i=Ot(o,r);if(!i)continue;const c=a[1],l=a[3],f=new Array(c.length),d=[];c.forEach((m,g)=>{he(m,d,w=>f[g]=w,n)});let u;if(!s){const m=$t(t,r);he(m,d,g=>u=g==null?void 0:g.default,n)}return d.length>0&&await Promise.all(d),[o,i,f,u,l]}return null},he=(e,t,n,r)=>{if(typeof e=="function"){const s=oe.get(e);if(s)n(s);else{const a=e();typeof a.then=="function"?t.push(a.then(o=>{r!==!1&&oe.set(e,o),n(o)})):a&&n(a)}}},$t=(e,t)=>{if(e){t=t.endsWith("/")?t:t+"/";const n=e.find(r=>r[0]===t||t.startsWith(r[0]));if(n)return n[1]}},Wt=e=>e&&typeof e.then=="function";function Nt(e){const t=[];return e==="day"?e=60*60*24:e==="week"?e=60*60*24*7:e==="month"?e=60*60*24*30:e==="year"?e=60*60*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:60*60*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e}),e.immutable&&t.push("immutable"),e.maxAge&&t.push(`max-age=${e.maxAge}`),e.sMaxAge&&t.push(`s-maxage=${e.sMaxAge}`),e.noStore&&t.push("no-store"),e.noCache&&t.push("no-cache"),e.private&&t.push("private"),e.public&&t.push("public"),e.staleWhileRevalidate&&t.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),e.staleIfError&&t.push(`stale-if-error=${e.staleIfError}`),t.join(", ")}var L;import("node:async_hooks").then(e=>{const t=e.AsyncLocalStorage;L=new t,globalThis.qcAsyncRequestStore=L}).catch(e=>{console.warn("AsyncLocalStorage not available, continuing without it. This might impact concurrent server calls.",e)});function Lt(e,t,n,r,s=!0,a="/",o){let i;const c=new Promise(f=>i=f),l=Ut(e,t,n,s,a,o,i);return{response:c,requestEv:l,completion:L?L.run(l,me,l,r,i):me(l,r,i)}}async function me(e,t,n){try{(o=>new URL(o.pathname+o.search,o))(e.originalUrl)}catch{const o="Resource Not Found";e.status(404);const i=B(404,o);return e.html(404,i),new N(404,o)}let r=1;async function s(){try{await e.next()}catch(a){if(a instanceof q)await e.getWritableStream().close();else if(a instanceof _e){if(r>50)throw new Error("Infinite rewrite loop");r+=1;const o=new URL(e.url);o.pathname=a.pathname;const{loadedRoute:i,requestHandlers:c}=await t(o);return e.resetRoute(i,c,o),await s()}else if(a instanceof N){if(!e.headersSent){const o=a.status,i=e.request.headers.get("Accept");if(i&&!i.includes("text/html")){const c=e[D];e.headers.set("Content-Type","application/qwik-json"),e.send(o,await c._serializeData(a.data,!0))}else{const c=B(a.status,a.data);e.html(o,c)}}}else if(!(a instanceof j)){if(z(e)!=="dev")try{e.headersSent||(e.headers.set("content-type","text/html; charset=utf-8"),e.cacheControl({noCache:!0}),e.status(500));const o=e.getWritableStream();if(!o.locked){const i=o.getWriter();await i.write(G.encode(B(500,"Internal Server Error"))),await i.close()}}catch{console.error("Unable to render error page")}return a}}}try{return await s()}finally{e.isDirty()||n(null)}}function Z(e,t){const n=e.endsWith(k);if(n){const r=e.length-k.length+(t?1:0);e=e.slice(0,r),e===""&&(e="/")}return{pathname:e,isInternal:n}}var ee="@isQData",k="/q-data.json",Oe=Symbol("RequestEvLoaders"),Pe=Symbol("RequestEvMode"),De=Symbol("RequestEvRoute"),D=Symbol("RequestEvQwikSerializer"),Me=Symbol("RequestEvTrailingSlash"),He="@routeName",Q="@actionId",$e="@actionFormData",It="@nonce",We="@rewrite";function Ut(e,t,n,r,s,a,o){const{request:i,platform:c,env:l}=e,f=new Map,d=new Ct(i.headers.get("cookie")),u=new Headers,m=new URL(i.url),{pathname:g,isInternal:w}=Z(m.pathname,r);w&&(m.pathname=g,f.set(ee,!0));let y=-1,S=null,A,ne=e.locale,T=200;const Ie=async()=>{for(y++;y<n.length;){const h=n[y],p=globalThis.qcAsyncRequestStore,b=p!=null&&p.run?p.run(R,h,R):h(R);Wt(b)&&await b,y++}},Ue=(h,p,b=m)=>{t=h,n=p,m.pathname=b.pathname,m.search=b.search,y=-1},_=()=>{if(S!==null)throw new Error("Response already sent")},H=(h,p)=>{if(_(),typeof h=="number"){T=h;const x=R.getWritableStream().getWriter();x.write(typeof p=="string"?G.encode(p):p),x.close()}else if(T=h.status,h.headers.forEach((b,x)=>{x.toLowerCase()!=="set-cookie"&&u.append(x,b)}),h.headers.getSetCookie().forEach(b=>{const x=b.indexOf("=");if(x===-1)return;const je=b.slice(0,x).trim(),Qe=b.slice(x+1).trim();d.set(je,Qe)}),h.body){const b=R.getWritableStream();h.body.pipeTo(b)}else R.getWritableStream().getWriter().close();return re()},re=()=>(y=X,new j),J={},R={[Oe]:J,[Pe]:e.mode,[Me]:r,get[De](){return t},[D]:a,cookie:d,headers:u,env:l,method:i.method,signal:i.signal,originalUrl:new URL(m),get params(){return(t==null?void 0:t[1])??{}},get pathname(){return m.pathname},platform:c,get query(){return m.searchParams},request:i,url:m,basePathname:s,sharedMap:f,get headersSent(){return S!==null},get exited(){return y>=X},get clientConn(){return e.getClientConn()},next:Ie,resetRoute:Ue,exit:re,cacheControl:(h,p="Cache-Control")=>{_(),u.set(p,Nt(h))},resolveValue:async h=>{const p=h.__id;if(h.__brand==="server_loader"&&!(p in J))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");return J[p]},status:h=>typeof h=="number"?(_(),T=h,h):T,locale:h=>(typeof h=="string"&&(ne=h),ne||""),error:(h,p)=>(T=h,u.delete("Cache-Control"),new N(h,p)),redirect:(h,p)=>{if(_(),T=h,p){if(/([^:])\/{2,}/.test(p)){const b=p.replace(/([^:])\/{2,}/g,"$1/");console.warn(`Redirect URL ${p} is invalid, fixing to ${b}`),p=b}u.set("Location",p)}return u.delete("Cache-Control"),h>301&&u.set("Cache-Control","no-store"),y=X,new q},rewrite:h=>{if(_(),h.startsWith("http"))throw new Error("Rewrite does not support absolute urls");return f.set(We,!0),new _e(h.replace(/\/+/g,"/"))},defer:h=>typeof h=="function"?h:()=>h,fail:(h,p)=>(_(),T=h,u.delete("Cache-Control"),{failed:!0,...p}),text:(h,p)=>(u.set("Content-Type","text/plain; charset=utf-8"),H(h,p)),html:(h,p)=>(u.set("Content-Type","text/html; charset=utf-8"),H(h,p)),parseBody:async()=>A!==void 0?A:A=Qt(R,f,a),json:(h,p)=>(u.set("Content-Type","application/json; charset=utf-8"),H(h,JSON.stringify(p))),send:H,isDirty:()=>S!==null,getWritableStream:()=>{if(S===null){if(e.mode==="dev"){const h=f.get("@serverTiming");h&&u.set("Server-Timing",h.map(p=>`${p[0]};dur=${p[1]}`).join(","))}S=e.getWritableStream(T,u,d,o,R)}return S}};return Object.freeze(R)}function F(e){return e[Oe]}function te(e){return e[Me]}function jt(e){return e[De]}function z(e){return e[Pe]}var X=Number.MAX_SAFE_INTEGER,Qt=async({request:e,method:t,query:n},r,s)=>{var a;const o=((a=e.headers.get("content-type"))==null?void 0:a.split(/[;,]/,1)[0].trim())??"";if(o==="application/x-www-form-urlencoded"||o==="multipart/form-data"){const i=await e.formData();return r.set($e,i),Ft(i)}else{if(o==="application/json")return await e.json();if(o==="application/qwik-json"){if(t==="GET"&&n.has(le)){const i=n.get(le);if(i)try{return s._deserializeData(decodeURIComponent(i))}catch{}}return s._deserializeData(await e.text())}}},Ft=e=>[...e.entries()].reduce((n,[r,s])=>(r.split(".").reduce((a,o,i,c)=>{if(o.endsWith("[]")){const l=o.slice(0,-2);return a[l]=a[l]||[],a[l]=[...a[l],s]}return i<c.length-1?a[o]=a[o]||(Number.isNaN(+c[i+1])?{}:[]):a[o]=s},n),n),{});function zt(e){const{params:t,request:n,status:r,locale:s,originalUrl:a}=e,o={};n.headers.forEach((w,y)=>o[y]=w);const i=e.sharedMap.get(Q),c=e.sharedMap.get($e),l=e.sharedMap.get(He),f=e.sharedMap.get(It),d=e.request.headers,u=new URL(a.pathname+a.search,a),m=d.get("X-Forwarded-Host"),g=d.get("X-Forwarded-Proto");return m&&(u.port="",u.host=m),g&&(u.protocol=g),{url:u.href,requestHeaders:o,locale:s(),nonce:f,containerAttributes:{"q:route":l},qwikcity:{routeName:l,ev:e,params:{...t},loadedRoute:jt(e),response:{status:r(),loaders:F(e),action:i,formData:c}}}}var Gt=(e,t,n,r,s,a)=>{const o=[],i=[],c=[],l=!!(t&&Et(t[2]));if(a&&c.push(en),e&&pe(o,i,c,e,l,n),t){const f=t[0];r&&(n==="POST"||n==="PUT"||n==="PATCH"||n==="DELETE")&&(r==="lax-proto"?c.unshift(Vt):c.unshift(Zt)),l&&((n==="POST"||n==="GET")&&c.push(Kt),c.push(Xt),a&&c.push(tn));const d=t[2];pe(o,i,c,d,l,n),l&&(c.push(u=>{u.sharedMap.set(He,f)}),c.push(Jt(i,o)),c.push(s))}return c},pe=(e,t,n,r,s,a)=>{for(const o of r){typeof o.onRequest=="function"?n.push(o.onRequest):Array.isArray(o.onRequest)&&n.push(...o.onRequest);let i;switch(a){case"GET":{i=o.onGet;break}case"POST":{i=o.onPost;break}case"PUT":{i=o.onPut;break}case"PATCH":{i=o.onPatch;break}case"DELETE":{i=o.onDelete;break}case"OPTIONS":{i=o.onOptions;break}case"HEAD":{i=o.onHead;break}}if(typeof i=="function"?n.push(i):Array.isArray(i)&&n.push(...i),s)for(const c of Object.values(o))typeof c=="function"&&(c.__brand==="server_loader"?e.push(c):c.__brand==="server_action"&&t.push(c))}};function Jt(e,t){return async n=>{if(n.headersSent){n.exit();return}const{method:r}=n,s=F(n),a=z(n)==="dev",o=n[D];if(a&&r==="GET"&&n.query.has(ce)&&console.warn(`Seems like you are submitting a Qwik Action via GET request. Qwik Actions should be submitted via POST request.
Make sure your <form> has method="POST" attribute, like this: <form method="POST">`),r==="POST"){const i=n.query.get(ce);if(i){const c=globalThis._qwikActionsMap,l=e.find(f=>f.__id===i)??(c==null?void 0:c.get(i));if(l){n.sharedMap.set(Q,i);const f=await n.parseBody();if(!f||typeof f!="object")throw new Error(`Expected request data for the action id ${i} to be an object`);const d=await ge(n,l.__validators,f,a);if(!d.success)s[i]=n.fail(d.status??500,d.error);else{const u=a?await U(n,l.__qrl.getSymbol().split("_",1)[0],()=>l.__qrl.call(n,d.data,n)):await l.__qrl.call(n,d.data,n);a&&I(o,u,l.__qrl),s[i]=u}}}}if(t.length>0){const i=t.map(c=>{const l=c.__id;return s[l]=ge(n,c.__validators,void 0,a).then(f=>f.success?a?U(n,c.__qrl.getSymbol().split("_",1)[0],()=>c.__qrl.call(n,n)):c.__qrl.call(n,n):n.fail(f.status??500,f.error)).then(f=>(typeof f=="function"?s[l]=f():(a&&I(o,f,c.__qrl),s[l]=f),f)),s[l]});await Promise.all(i)}}}async function ge(e,t,n,r){let s={success:!0,data:n};if(t)for(const a of t)if(r?s=await U(e,"validator$",()=>a.validate(e,n)):s=await a.validate(e,n),s.success)n=s.data;else return s;return s}function Bt(e){return e?typeof e=="object"&&Symbol.asyncIterator in e:!1}async function Kt(e){const t=e.query.get(kt);if(t&&e.request.headers.get("X-QRL")===t&&e.request.headers.get("Content-Type")==="application/qwik-json"){e.exit();const n=z(e)==="dev",r=e[D],s=await e.parseBody();if(Array.isArray(s)){const[a,...o]=s;if(Yt(a)&&a.getHash()===t){let i;try{n?i=await U(e,`server_${a.getSymbol()}`,()=>a.apply(e,o)):i=await a.apply(e,o)}catch(c){throw c instanceof N?e.error(c.status,c.data):e.error(500,"Invalid request")}if(Bt(i)){e.headers.set("Content-Type","text/qwik-json-stream");const l=e.getWritableStream().getWriter();for await(const f of i){n&&I(r,f,a);const d=await r._serializeData(f,!0);if(e.signal.aborted)break;await l.write(G.encode(`${d}
`))}l.close()}else{I(r,i,a),e.headers.set("Content-Type","application/qwik-json");const c=await r._serializeData(i,!0);e.send(200,c)}return}}throw e.error(500,"Invalid request")}}function Xt(e){const t=te(e),{basePathname:n,originalUrl:r,sharedMap:s}=e,{pathname:a,search:o}=r;if(!s.has(ee)&&a!==n&&!a.endsWith(".html")){if(t){if(!a.endsWith("/"))throw e.redirect(301,a+"/"+o)}else if(a.endsWith("/"))throw e.redirect(301,a.slice(0,a.length-1)+o)}}function I(e,t,n){try{e._verifySerializable(t,void 0)}catch(r){throw r instanceof Error&&n.dev&&(r.loc=n.dev),r}}var Yt=e=>typeof e=="function"&&typeof e.getSymbol=="function";function Et(e){const t=e[e.length-1];return t&&typeof t.default=="function"}function Ne(e,t){e=new URL(e),e.pathname.endsWith(k)&&(e.pathname=e.pathname.slice(0,-k.length)),t?e.pathname.endsWith("/")||(e.pathname+="/"):e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1));const n=e.search.slice(1).replaceAll(/&?q(action|data|func)=[^&]+/g,"");return`${e.pathname}${n?`?${n}`:""}${e.hash}`}var G=new TextEncoder;function Vt(e){Le(e,"lax-proto")}function Zt(e){Le(e)}function Le(e,t){if(rn(e.request.headers,"application/x-www-form-urlencoded","multipart/form-data","text/plain")){const r=e.request.headers.get("origin"),s=e.url.origin;let a=r!==s;if(a&&t&&(r==null?void 0:r.replace(/^http(s)?/g,""))===s.replace(/^http(s)?/g,"")&&(a=!1),a)throw e.error(403,`CSRF check failed. Cross-site ${e.method} form submissions are forbidden.
The request origin "${r}" does not match the server origin "${s}".`)}}function qt(e){return async t=>{if(t.headersSent||t.sharedMap.has(ee))return;t.request.headers.forEach((d,u)=>d);const r=t.headers;r.has("Content-Type")||r.set("Content-Type","text/html; charset=utf-8");const s=te(t),{readable:a,writable:o}=new TextEncoderStream,i=t.getWritableStream(),c=a.pipeTo(i,{preventClose:!0}),l=o.getWriter(),f=t.status();try{const d=z(t)==="static",u=zt(t),m=await e({base:t.basePathname+"build/",stream:l,serverData:u,containerAttributes:{"q:render":d?"static":"",...u.containerAttributes}}),g={loaders:F(t),action:t.sharedMap.get(Q),status:f!==200?f:200,href:Ne(t.url,s)};typeof m.html=="string"&&await l.write(m.html),t.sharedMap.set("qData",g)}finally{await l.ready,await l.close(),await c}await i.close()}}async function en(e){try{await e.next()}catch(s){if(!(s instanceof q))throw s}if(e.headersSent)return;const t=e.status(),n=e.headers.get("Location");if(t>=301&&t<=308&&n){const s=nn(n);if(s){e.headers.set("Location",s),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}}async function tn(e){if(await e.next(),e.headersSent||e.exited)return;const t=e.status(),n=e.headers.get("Location"),r=te(e);e.request.headers.forEach((c,l)=>c),e.headers.set("Content-Type","application/json; charset=utf-8");const s={loaders:F(e),action:e.sharedMap.get(Q),status:t!==200?t:200,href:Ne(e.url,r),redirect:n??void 0,isRewrite:e.sharedMap.get(We)},a=e.getWritableStream().getWriter(),i=await e[D]._serializeData(s,!0);a.write(G.encode(i)),e.sharedMap.set("qData",s),a.close()}function nn(e){if(e.startsWith("/")){if(!e.includes(k)){const t=new URL(e,"http://localhost");return(t.pathname.endsWith("/")?t.pathname.slice(0,-1):t.pathname)+k+t.search}return e}else return}function ye(){return typeof performance<"u"?performance.now():0}async function U(e,t,n){const r=ye();try{return await n()}finally{const s=ye()-r;let a=e.sharedMap.get("@serverTiming");a||e.sharedMap.set("@serverTiming",a=[]),a.push([t,s])}}function rn(e,...t){var n;const r=((n=e.get("content-type"))==null?void 0:n.split(/;/,1)[0].trim())??"";return t.includes(r)}async function an(e,t,n){const{render:r,qwikCityPlan:s,checkOrigin:a}=t,{pathname:o,isInternal:i}=Z(e.url.pathname,s.trailingSlash),c=await we(s,o,e.request.method,a??!0,r,i);if(c){const[l,f]=c;return Lt(e,l,f,async u=>{const{pathname:m}=Z(u.pathname,s.trailingSlash),g=await we(s,m,e.request.method,a??!0,r,i);if(g){const[w,y]=g;return{loadedRoute:w,requestHandlers:y}}else return{loadedRoute:null,requestHandlers:[]}},s.trailingSlash,s.basePathname,n)}return null}async function we(e,t,n,r,s,a){const{routes:o,serverPlugins:i,menus:c,cacheModules:l}=e,f=await Ht(o,c,l,t,a),d=Gt(i,f,n,r,qt(s),a);return d.length>0?[f,d]:null}function Y(e,t){var n;return((n=t==null?void 0:t.getOrigin)==null?void 0:n.call(t,e))??(t==null?void 0:t.origin)??process.env.ORIGIN??sn(e)}function sn(e){const{PROTOCOL_HEADER:t,HOST_HEADER:n}=process.env,r=e.headers,s=t&&r[t]||(e.socket.encrypted||e.connection.encrypted?"https":"http"),a=n??(e instanceof Ze?":authority":"host"),o=r[a];return`${s}://${o}`}function E(e,t){return cn(e.originalUrl||e.url||"/",t)}function on(e=""){return["The stream has been destroyed","write after end"].some(n=>e.includes(n))}var be=/^:(method|scheme|authority|path)$/i;function cn(e,t){const n=/\/\/|\\\\/g;return new URL(e.replace(n,"/"),t)}async function ln(e,t,n,r,s){const a=new Headers,o=t.headers;try{for(const[u,m]of Object.entries(o))if(!be.test(u)){if(typeof m=="string")a.set(u,m);else if(Array.isArray(m))for(const g of m)a.append(u,g)}}catch(u){console.error(u)}const i=async function*(){for await(const u of t)yield u},c=t.method==="HEAD"||t.method==="GET"?void 0:i(),l=new AbortController,f={method:t.method,headers:a,body:c,signal:l.signal,duplex:"half"};return n.on("close",()=>{l.abort()}),{mode:r,url:e,request:new Request(e.href,f),env:{get(u){return process.env[u]}},getWritableStream:(u,m,g)=>{n.statusCode=u;try{for(const[y,S]of m)be.test(y)||n.setHeader(y,S);const w=g.headers();w.length>0&&n.setHeader("Set-Cookie",w)}catch(w){console.error(w)}return new WritableStream({write(w){n.closed||n.destroyed||n.write(w,y=>{y&&!on(y.message)&&console.error(y)})},close(){n.end()}})},getClientConn:()=>s?s(t):{ip:t.socket.remoteAddress},platform:{ssr:!0,incomingMessage:t,node:process.versions.node},locale:void 0}}var fn={"3gp":"video/3gpp","3gpp":"video/3gpp",asf:"video/x-ms-asf",asx:"video/x-ms-asf",avi:"video/x-msvideo",avif:"image/avif",bmp:"image/x-ms-bmp",css:"text/css",flv:"video/x-flv",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",jng:"image/x-jng",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",kar:"audio/midi",m4a:"audio/x-m4a",m4v:"video/x-m4v",mid:"audio/midi",midi:"audio/midi",mng:"video/x-mng",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",ogg:"audio/ogg",pdf:"application/pdf",png:"image/png",rar:"application/x-rar-compressed",shtml:"text/html",svg:"image/svg+xml",svgz:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",txt:"text/plain",wbmp:"image/vnd.wap.wbmp",webm:"video/webm",webp:"image/webp",wmv:"video/x-ms-wmv",woff:"font/woff",woff2:"font/woff2",xml:"text/xml",zip:"application/zip"};function un(){typeof global<"u"&&typeof globalThis.fetch!="function"&&typeof process<"u"&&process.versions.node&&(globalThis.fetch=rt,globalThis.Headers=at,globalThis.Request=it,globalThis.Response=st,globalThis.FormData=ot),typeof globalThis.TextEncoderStream>"u"&&(globalThis.TextEncoderStream=qe,globalThis.TextDecoderStream=et),typeof globalThis.WritableStream>"u"&&(globalThis.WritableStream=tt,globalThis.ReadableStream=nt),typeof globalThis.crypto>"u"&&(globalThis.crypto=ct.webcrypto)}function dn(e){var t;un();const n={_deserializeData:ut,_serializeData:ft,_verifySerializable:lt};e.manifest&&Ge(e.manifest);const r=((t=e.static)==null?void 0:t.root)??$(Ve(import.meta.url),"..","..","dist");return{router:async(i,c,l)=>{try{const f=Y(i,e),d=await ln(E(i,f),i,c,"server",e.getClientConn),u=await an(d,e,n);if(u){const m=await u.completion;if(m)throw m;if(u.requestEv.headersSent)return}l()}catch(f){console.error(f),l(f)}},notFound:async(i,c,l)=>{try{if(!c.headersSent){const f=Y(i,e),d=E(i,f),u=ae(i.method||"GET",d)?"Not Found":Ke(d.pathname);c.writeHead(404,{"Content-Type":"text/html; charset=utf-8","X-Not-Found":d.pathname}),c.end(u)}}catch(f){console.error(f),l(f)}},staticFile:async(i,c,l)=>{var f;try{const d=Y(i,e),u=E(i,d);if(ae(i.method||"GET",u)){const m=u.pathname;let g;Ye(m).includes(".")?g=$(r,m):e.qwikCityPlan.trailingSlash?g=$(r,m+"index.html"):g=$(r,m,"index.html");const w=Ee(g).replace(/^\./,""),y=Xe(g);y.on("error",l);const S=fn[w];S&&c.setHeader("Content-Type",S),(f=e.static)!=null&&f.cacheControl&&c.setHeader("Cache-Control",e.static.cacheControl),y.pipe(c);return}return l()}catch(d){console.error(d),l(d)}}}}const hn=()=>V(pt,{children:[P("head",null,null,[P("meta",null,{charSet:"utf-8"},null,3,null),P("meta",null,{name:"viewport",content:"width=device-width, initial-scale=1.0"},null,3,null),P("link",null,{rel:"manifest",href:"/manifest.json"},null,3,null)],3,null),P("body",null,null,V(mt,null,3,"0T_0"),1,null)]},1,"0T_1"),mn=dt(ht(hn,"s_CPq5fIrJ5OE"));function pn(e){return Je(V(mn,null,3,"Dl_0"),{...e,containerAttributes:{lang:"en",...e.containerAttributes}})}const{router:gn,notFound:yn}=dn({render:pn,qwikCityPlan:gt,manifest:Be}),M=Ae();M.use(yt());M.use(Ae.static("dist/client",{maxAge:"1y",immutable:!0}));M.use(gn);M.use(yn);const Se=process.env.PORT||3e3,Re=process.env.HOST||"0.0.0.0";M.listen(Se,Re,()=>{console.log(`âœ… SSR Server ready: http://${Re}:${Se}/`)});
